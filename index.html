<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TOOL TÀI XĨU VIP</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap');
        
        body { 
            background: #000; 
            color: #fff; 
            font-family: 'Orbitron', sans-serif; 
            height: 100vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            overflow: hidden;
            user-select: none;
        }

        .glass-card { 
            background: rgba(10, 15, 30, 0.98); 
            border: 1px solid rgba(34, 211, 238, 0.2); 
            border-radius: 30px; 
            width: 90%; 
            max-width: 400px; 
            padding: 2.5rem;
            box-shadow: 0 0 50px rgba(0, 242, 255, 0.1);
        }

        .tai-neon { color: #00f2ff; text-shadow: 0 0 20px #00f2ff; }
        .xiu-neon { color: #ff0055; text-shadow: 0 0 20px #ff0055; }
        .hidden { display: none !important; }

        input, textarea {
            background: #050a15 !important;
            border: 1px solid #1e293b !important;
            color: #22d3ee !important;
            outline: none !important;
            transition: 0.3s;
        }

        input:focus { border-color: #22d3ee !important; box-shadow: 0 0 10px rgba(34, 211, 238, 0.3); }

        .btn-glow {
            background: linear-gradient(90deg, #0891b2, #1e40af);
            box-shadow: 0 0 15px rgba(8, 145, 178, 0.4);
        }
    </style>
</head>
<body oncontextmenu="return false;">

    <div class="glass-card">
        <div id="login-ui" class="space-y-8">
            <div class="text-center">
                <h1 class="text-3xl font-black italic tracking-tighter text-cyan-500">ALEX SYSTEM</h1>
                <p class="text-[10px] text-slate-500 mt-2">SECURE ACCESS v2.0</p>
            </div>

            <div class="space-y-4">
                <input id="key-input" type="text" placeholder="ENTER ACCESS KEY" 
                    class="w-full p-4 rounded-2xl text-center font-bold uppercase tracking-widest">
                
                <button onclick="validateKey()" id="btn-login" 
                    class="w-full py-4 rounded-2xl btn-glow font-bold active:scale-95 transition-all">
                    KÍCH HOẠT HỆ THỐNG
                </button>
            </div>
            
            <div class="text-center text-[8px] text-slate-700">
                HWID: <span id="dev-id">FETCHING...</span>
            </div>
        </div>

        <div id="tool-ui" class="hidden space-y-6">
            <div class="flex justify-between items-center text-[9px] border-b border-cyan-900/50 pb-2">
                <span class="text-green-500 animate-pulse font-bold">● VPS SERVER CONNECTED</span>
                <span id="clock" class="text-slate-500">00:00:00</span>
            </div>

            <div class="space-y-4">
                <textarea id="md5-input" placeholder="PASTE MD5 HASH HERE..." 
                    class="w-full p-4 h-28 rounded-2xl text-[11px] uppercase resize-none leading-relaxed"></textarea>
                
                <button onclick="analyzeMD5()" id="btn-ana" 
                    class="w-full py-5 rounded-2xl btn-glow font-bold italic tracking-wider active:scale-95">
                    PHÂN TÍCH DỮ LIỆU
                </button>
            </div>

            <div id="result-box" class="hidden bg-black/60 rounded-3xl p-8 text-center border border-cyan-500/10 shadow-inner">
                <p class="text-[8px] text-slate-500 mb-4 tracking-[0.5em]">PREDICTION RESULT</p>
                <h2 id="final-res" class="text-7xl font-black italic">...</h2>
            </div>
        </div>
    </div>

    <script>
        // ================= CẤU HÌNH BẢO MẬT (PHẢI TRÙNG VỚI VPS) =================
        const API_SERVER = "http://160.187.246.184:3000"; // Thay IP VPS của bạn vào đây
        const API_SECRET = "ALEX_SECRET_999";           // Khớp với Secret trong server.js
        // =========================================================================

        const tg = window.Telegram.WebApp;
        tg.expand();
        
        // Lấy ID người dùng làm Device ID
        const userId = tg.initDataUnsafe.user?.id || "GUEST_USER";
        document.getElementById('dev-id').innerText = userId;

        // 1. HÀM XÁC THỰC KEY QUA VPS
        async function validateKey() {
            const key = document.getElementById('key-input').value.trim().toUpperCase();
            if(!key) return tg.showAlert("Vui lòng nhập Key!");

            const btn = document.getElementById('btn-login');
            btn.innerText = "AUTHENTICATING...";
            btn.disabled = true;

            try {
                const res = await fetch(`${API_SERVER}/api/verify`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ 
                        key: key, 
                        deviceId: userId.toString(),
                        secret: API_SECRET 
                    })
                });
                
                const data = await res.json();

                if(data.success) {
                    document.getElementById('login-ui').classList.add('hidden');
                    document.getElementById('tool-ui').classList.remove('hidden');
                    tg.HapticFeedback.notificationOccurred('success');
                } else {
                    tg.showAlert(data.msg);
                    tg.HapticFeedback.notificationOccurred('error');
                }
            } catch (e) {
                tg.showAlert("LỖI: Không thể kết nối tới Server VPS!\nHãy kiểm tra IP và Port 3000.");
            } finally {
                btn.innerText = "KÍCH HOẠT HỆ THỐNG";
                btn.disabled = false;
            }
        }

        // 2. THUẬT TOÁN PHÂN TÍCH MD5
        function analyzeMD5() {
            const raw = document.getElementById('md5-input').value.trim();
            if (raw.length < 10) return tg.showAlert("Mã MD5 không hợp lệ!");

            const btn = document.getElementById('btn-ana');
            btn.innerText = "DECRYPTING...";
            btn.disabled = true;

            setTimeout(() => {
                // Thuật toán băm chuỗi dựa trên mã ASCII
                let hashSum = 0;
                for (let i = 0; i < raw.length; i++) {
                    hashSum += raw.charCodeAt(i) * (i + 1);
                }
                
                const isTai = hashSum % 2 === 0;
                const resultBox = document.getElementById('result-box');
                const resText = document.getElementById('final-res');

                resultBox.classList.remove('hidden');
                resText.innerText = isTai ? "TÀI" : "XỈU";
                resText.className = `text-7xl font-black italic ${isTai ? 'tai-neon' : 'xiu-neon'}`;
                
                btn.innerText = "PHÂN TÍCH DỮ LIỆU";
                btn.disabled = false;
                tg.HapticFeedback.impactOccurred('heavy');
            }, 1500);
        }

        // Cập nhật đồng hồ
        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        }, 1000);

        // 3. CHẶN PHÍM F12 VÀ KIỂM TRA PHẦN TỬ (CHỐNG CRACK)
        document.onkeydown = function(e) {
            if (e.keyCode == 123 || 
                (e.ctrlKey && e.shiftKey && (e.keyCode == 'I'.charCodeAt(0) || e.keyCode == 'J'.charCodeAt(0))) || 
                (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0))) {
                return false;
            }
        };
    </script>
</body>
</html>
